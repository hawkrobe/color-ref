---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(knitr)
library(scales)
library(xtable)
library(broom)
```


```{r}
d = read_csv('./expectation/expectations-by-condition.csv') 
```

# using all data
```{r}
library("ggpubr")
ggboxplot(d, y = "sliderResponse", 
          color = "condition", palette = c("#00AFBB", "#E7B800"),
          order = c("abstract", "concrete"),
          ylab = "% of population expected to share one's color association", xlab="words")
```

# using top 10 and bottom 10 entropy words
```{r}
library(dplyr)
selectedWords <- filter(d, word %in% c("lemon", "sun", "tomato", "fire", "apple", "spinach", "vegetable", "tree", "daffodil", 'noun', 'misconception', 'peculiarity', 'tendency', 'obligation', 'randomness', 'oddity', 'complexity', 'responsibility', 'absurdity'))

library("ggpubr")
ggboxplot(selectedWords, y = "sliderResponse", 
          color = "condition", palette = c("#00AFBB", "#E7B800"),
          order = c("abstract", "concrete"),
          ylab = "% of population expected to share one's color association", xlab="words")
```

# plotting top and bottom 10 words individually
```{r}
boxplot(sliderResponse~word, data=selectedWords, main="Expected Agreement",
   xlab="Words", ylab="% of population expected to share one's color association")
```
# compare expectation to entropy for each word
```{r}

filtered <- d %>%
  mutate(sliderResponse = as.numeric(sliderResponse))
# calculate mean per group 
avgExpectation <- aggregate(filtered$sliderResponse, by = list(filtered$word), FUN = mean)

# load and format entropy data
f = read_csv('./entropy/sorted-entropies-all-both.csv') 

f = f %>%
  mutate(both = as.numeric(both))

scatter.smooth(x=f$both, y=avgExpectation$x, xlab = "Entropy of participants' color associations for all words", ylab = "Average % of population expected to share one's color association")
```
# attempt to combine entropy ratings and slider responses to do a mixed effect model with subject as the random effect

```{r}
library(lme4)

mixedModel <- lmer(entropy$filtered ~ sliderResponse$d  + (1|aID$d))
summary(mixedModel)
```


