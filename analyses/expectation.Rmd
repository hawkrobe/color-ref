---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(knitr)
library(scales)
library(xtable)
library(broom)
```

# Expectation ratings box plot
```{r}
dExpectation = read_csv('./expectation/expectations-by-condition.csv') 

library("ggpubr")
ggboxplot(dExpectation, y = "sliderResponse", main= "Expected Agreement by Condition",
          color = "condition", palette = c("#D8644B", "#4B7CD8"),
          order = c("concrete", "abstract"), ylim = c(0, 100),
          ylab = "% of population expected to share one's color association", xlab="words")
```

# Ground truth boxplot
```{r}
dTruth = read_csv('./expectation/ground-truth-by-condition.csv') 

ggboxplot(dTruth, y = "groundTruth", main= "Actual Agreement by Condition",
          color = "condition", palette = c("#D8644B", "#4B7CD8"),
          order = c("concrete", "abstract"), ylim = c(0, 100),
          ylab = "% of population actually sharing color association", xlab="words")
```

# plotting expectation for top and bottom 10 words individually
```{r}
selectedWords <- filter(dExpectation, word %in% c("lemon", "sun", "tomato", "fire", "apple", "spinach", "vegetable", "tree", "daffodil"))

boxplot(sliderResponse~word, data=selectedWords, main="Expected Agreement",
   xlab="Words", ylab="% of population expected to share one's color association", ylim = c(0, 100))
```

# plotting actual agreement for top 10 words individually
```{r}
selectedWords <- filter(dTruth, word %in% c("lemon", "sun", "tomato", "fire", "apple", "spinach", "vegetable", "tree", "daffodil"))

boxplot(groundTruth~word, data=selectedWords, main="Actual Agreement",
   xlab="Words", ylab="% of population expected to share one's color association", ylim = c(0, 100))
```


<!-- # compare expectation to entropy for each word -->
<!-- ```{r} -->

<!-- filtered <- d %>% -->
<!--   mutate(sliderResponse = as.numeric(sliderResponse)) -->
<!-- # calculate mean per group  -->
<!-- avgExpectation <- aggregate(filtered$sliderResponse, by = list(filtered$word), FUN = mean) -->

<!-- # load and format entropy data -->
<!-- f = read_csv('./entropy/sorted-entropies-all-both.csv')  -->

<!-- f = f %>% -->
<!--   mutate(both = as.numeric(both)) -->

<!-- scatter.smooth(x=f$both, y=avgExpectation$x, xlab = "Entropy of participants' color associations for all words", ylab = "Average % of population expected to share one's color association") -->
<!-- ``` -->

<!-- # attempt to combine entropy ratings and slider responses to do a mixed effect model with subject as the random effect -->
<!-- ```{r} -->
<!-- library(lme4) -->

<!-- # NEED TO JOIN DATAFRAMES -->
<!-- mixedModel <- lmer(filtered$entropy ~ d$sliderResponse  + (1|d$aID)) -->
<!-- summary(mixedModel) -->
<!-- ``` -->


